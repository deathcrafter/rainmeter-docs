<!DOCTYPE html>
<html lang="en">
<head><meta name="generator" content="Hexo 3.8.0">
	<!-- Meta tags for proper character encoding and social media handling  -->
	<meta charset="utf-8">
	<meta name="viewport" content="user-scalable=no, width=device-width, initial-scale=0.9, maximum-scale=0.9">
	<meta itemprop="name" content="WindowMessage plugin - Rainmeter Docs">
	<meta property="og:title" content="WindowMessage plugin - Rainmeter Docs">
	<meta property="og:type" content="website">
	<meta property="og:url" content="https://www.rainmeter.net">
	<meta property="og:image" content="https://www.rainmeter.net/img/media_image.png">
	<meta property="og:site_name" content="Rainmeter">
	<meta property="og:locale" content="en_US">

	<!-- Page title  -->
	<title>WindowMessage plugin - Rainmeter</title>

	<!-- Files need to be local for offline version of documentations -->
	<link rel="stylesheet" href="/css/bootstrap.min.css">
	<link rel="stylesheet" href="/css/rainmeter.css">
	<link rel="stylesheet" href="/css/jquery.fancybox.min.css">

	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600">
	<link href="https://fonts.googleapis.com/css?family=Nunito:400,700" rel="stylesheet">

	<!-- Site icon -->
	<link rel="shortcut icon" href="//www.rainmeter.net/favicon.ico">

</head>

<body>

  <!-- Get current path and set it as an variable -->


<!-- Include navbar -->
<nav id="navbar" class="navbar navbar-expand-lg navbar-dark">
	<div class="container">
		<a class="navbar-brand" href="https://docs.rainmeter.net"><img src="\img\logo_nav.png" alt></a>
		<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#mainNavigation" aria-controls="mainNavigation" aria-expanded="false" aria-label="Toggle navigation">
			<span class="navbar-toggler-icon"></span>
		</button>
		<div class="collapse navbar-collapse justify-content-end" id="mainNavigation">
			<ul class="navbar-nav order-12">
				<li class="nav-item "><a class="nav-link" href="//rainmeter.net/">Home</a></li>
				<li class="nav-item active"><a class="nav-link" href="//docs.rainmeter.net/">Documentation</a></li>
				<li class="nav-item "><a class="nav-link" href="//rainmeter.net/discover">Discover</a></li>
				<li class="nav-item "><a class="nav-link" href="//forum.rainmeter.net">Community</a></li>
				<div class="dropdown-divider"></div>
			</ul>
		</div>
	</div>
</nav>

<div id="content">
    <div id="nav-button" class="docs-nav-button">
      <div class="container d-flex flex-row align-items-center">
      <svg onclick="openNavMenu()" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg>
      <a onclick="openNavMenu()">Open navigation</a>
  </div>
</div>

  <div class="container">
    <div class="row">

      <!-- Sidenav -->
      <div id="menu" class="docs-nav col-12 col-lg-3">
        

<h4 id="category"><a href="/manual-beta">4.4 Beta Manual</a></h4>
<svg class="closeButton" onclick="closeNavMenu()" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
<form id="search-form" method="get" action="https://www.google.com/search">
  <input name="sitesearch" value="docs.rainmeter.net" type="hidden">
  <input class="form-control" id="search" name="q" maxlength="255" size="16" placeholder="Search" type="text">
</form>
<hr>
<nav id="sidenav" class="sidenav">
<h4>Contents</h4>
<ul class="docs-nav-block">
	<li><a href="/manual-beta/getting-started/">Getting Started</a>
		<ul>
		<li><a href="/manual-beta/getting-started/setting-up/">Setting Up</a>
		</li><li><a href="/manual-beta/getting-started/using-rainmeter/">Using Rainmeter</a>
		</li><li><a href="/manual-beta/getting-started/customizing/">Customizing</a>
		</li><li><a href="/manual-beta/getting-started/creating-skins/">Creating Skins</a>
		</li><li><a href="/manual-beta/getting-started/skin-anatomy/">Anatomy of a Skin</a>
		</li><li><a href="/manual-beta/getting-started/basic-tutorials/">Basic Tutorials</a>
			<ul>
			<li><a href="/manual-beta/getting-started/basic-tutorials/launcher/">Launcher</a>
			</li><li><a href="/manual-beta/getting-started/basic-tutorials/clock/">Clock</a>
			</li><li><a href="/manual-beta/getting-started/basic-tutorials/system/">System</a>
			</li></ul>
		</li></ul>
	</li><li><a href="/manual-beta/installing-rainmeter/">Installing Rainmeter</a>
	</li><li><a href="/manual-beta/user-interface/">User Interface</a>
		<ul>
		<li><a href="/manual-beta/user-interface/manage/">Manage</a>
	<ul>
		<li><a href="/manual-beta/user-interface/manage/new-skin">New Skin</a>
	</li></ul>
		</li><li><a href="/manual-beta/user-interface/about/">About</a>
		</li><li><a href="/manual-beta/user-interface/context-menus/">Context Menus</a>
		</li></ul>
	</li><li><a href="/manual-beta/installing-skins/">Installing Skins</a>
	</li><li><a href="/manual-beta/arranging-skins/">Arranging Skins</a>
	</li><li><a href="/manual-beta/distributing-skins/">Distributing Skins</a>
	<ul>
		<li><a href="/manual-beta/distributing-skins/vault-folder/">@Vault Folder</a>
	</li></ul>
	</li></ul>

	<h4>Reference</h4>
	<ul class="docs-nav-block">
	<li><a href="/manual-beta/settings/">Settings</a>
		<ul>
		<li><a href="/manual-beta/settings/rainmeter-section/">[Rainmeter] Section</a>
		</li><li><a href="/manual-beta/settings/traymeasure-section/">[TrayMeasure] Section</a>
		</li><li><a href="/manual-beta/settings/skin-sections/">[Skin] Sections</a>
		</li></ul>
	</li><li><a href="/manual-beta/skins/">Skins</a>
		<ul>
		<li><a href="/manual-beta/skins/option-types/">Option Types</a>
		</li><li><a href="/manual-beta/skins/rainmeter-section/">[Rainmeter] Section</a>
	<ul>
		<li><a href="/manual-beta/skins/rainmeter-section/defaults/">Default Settings</a>
	</li></ul>
		</li><li><a href="/manual-beta/skins/metadata-section/">[Metadata] Section</a>
		</li><li><a href="/manual-beta/skins/include-option/">@Include Options</a>
		</li><li><a href="/manual-beta/skins/resources-folder/">@Resources Folder</a>
		</li></ul>
	</li><li><a href="/manual-beta/meters/">Meters</a>
		<ul>
		<li><a href="/manual-beta/meters/general-options/">General Options</a>
			<ul>
			<li><a href="/manual-beta/meters/general-options/image-options/">Image Options</a>
			</li><li><a href="/manual-beta/meters/general-options/meterstyles/">MeterStyles</a>
			</li><li><a href="/manual-beta/meters/general-options/tooltips/">Tooltips</a>
			</li><li><a href="/manual-beta/meters/general-options/container/">Container</a>
			</li></ul>
		</li><li><a href="/manual-beta/meters/bar/">Bar</a>
		</li><li><a href="/manual-beta/meters/bitmap/">Bitmap</a>
		</li><li><a href="/manual-beta/meters/button/">Button</a>
		</li><li><a href="/manual-beta/meters/histogram/">Histogram</a>
		</li><li><a href="/manual-beta/meters/image/">Image</a>
		</li><li><a href="/manual-beta/meters/line/">Line</a>
		</li><li><a href="/manual-beta/meters/rotator/">Rotator</a>
		</li><li><a href="/manual-beta/meters/roundline/">Roundline</a>
		</li><li><a href="/manual-beta/meters/shape/">Shape</a>
		</li><li><a href="/manual-beta/meters/string/">String</a>
	<ul>
		<li><a href="/manual-beta/meters/string/inline/">Inline Options</a>
	</li></ul>
		</li></ul>
	</li><li><a href="/manual-beta/measures/">Measures</a>
		<ul>
		<li><a href="/manual-beta/measures/general-options/">General Options</a>
			<ul>
			<li><a href="/manual-beta/measures/general-options/ifactions/">IfActions</a>
			</li><li><a href="/manual-beta/measures/general-options/ifconditions/">IfConditions</a>
			</li><li><a href="/manual-beta/measures/general-options/ifmatchactions/">IfMatchActions</a>
			</li><li><a href="/manual-beta/measures/general-options/substitute/">Substitute</a>
			</li></ul>
		</li><li><a href="/manual-beta/measures/calc/">Calc</a>
		</li><li><a href="/manual-beta/measures/cpu/">CPU</a>
		</li><li><a href="/manual-beta/measures/freediskspace/">FreeDiskSpace</a>
		</li><li><a href="/manual-beta/measures/loop/">Loop</a>
		</li><li><a href="/manual-beta/measures/mediakey/">MediaKey</a>
		</li><li><a href="/manual-beta/measures/memory/">Memory</a>
		</li><li><a href="/manual-beta/measures/net/">Net</a>
		</li><li><a href="/manual-beta/measures/nowplaying/">NowPlaying</a>
		</li><li><a href="/manual-beta/measures/plugin/">Plugin</a>
		</li><li><a href="/manual-beta/measures/process/">Process</a>
		</li><li><a href="/manual-beta/measures/recyclemanager/">RecycleManager</a>
		</li><li><a href="/manual-beta/measures/registry/">Registry</a>
		</li><li><a href="/manual-beta/measures/script/">Script</a>
		</li><li><a href="/manual-beta/measures/string/">String</a>
		</li><li><a href="/manual-beta/measures/time/">Time</a>
		</li><li><a href="/manual-beta/measures/uptime/">Uptime</a>
		</li><li><a href="/manual-beta/measures/webparser/">WebParser</a>
		</li></ul>
	</li><li><a href="/manual-beta/plugins/">Plugins</a>
		<ul>
		<li><a href="/manual-beta/plugins/actiontimer/">ActionTimer</a>
		</li><li><a href="/manual-beta/plugins/audiolevel/">AudioLevel</a>
		</li><li><a href="/manual-beta/plugins/coretemp/">CoreTemp</a>
		</li><li><a href="/manual-beta/plugins/fileview/">FileView</a>
		</li><li><a href="/manual-beta/plugins/folderinfo/">FolderInfo</a>
		</li><li><a href="/manual-beta/plugins/inputtext/">InputText</a>
		</li><li><a href="/manual-beta/plugins/ping/">Ping</a>
		</li><li><a href="/manual-beta/plugins/power/">Power</a>
		</li><li><a href="/manual-beta/plugins/quote/">Quote</a>
		</li><li><a href="/manual-beta/plugins/resmon/">ResMon</a>
		</li><li><a href="/manual-beta/plugins/runcommand/">RunCommand</a>
		</li><li><a href="/manual-beta/plugins/speedfan/">SpeedFan</a>
		</li><li><a href="/manual-beta/plugins/sysinfo/">SysInfo</a>
		</li><li><a href="/manual-beta/plugins/usagemonitor/">UsageMonitor</a>
		</li><li><a href="/manual-beta/plugins/wifistatus/">WiFiStatus</a>
		</li><li><a href="/manual-beta/plugins/win7audio/">Win7Audio</a>
		</li><li><a href="/manual-beta/plugins/windowmessage/">WindowMessage</a>
		</li><li><a href="/manual-beta/plugins/deprecated/">Deprecated Plugins</a>
			<ul>
			<li><a href="/manual-beta/plugins/deprecated/advancedcpu/">AdvancedCPU</a>
			</li><li><a href="/manual-beta/plugins/deprecated/itunes/">iTunes</a>
			</li><li><a href="/manual-beta/plugins/deprecated/perfmon/">PerfMon</a>
			</li></ul>
		</li></ul>
	</li><li><a href="/manual-beta/bangs/">Bangs</a>
	</li><li><a href="/manual-beta/formulas/">Formulas</a>
	</li><li><a href="/manual-beta/variables/">Variables</a>
		<ul>
		<li><a href="/manual-beta/variables/nesting-variables/">Nesting Variables</a>
		</li><li><a href="/manual-beta/variables/built-in-variables/">Built-In Variables</a>
		</li><li><a href="/manual-beta/variables/section-variables/">Section Variables</a>
		</li><li><a href="/manual-beta/variables/character-variables/">Character Variables</a>
		</li><li><a href="/manual-beta/variables/mouse-variables/">Mouse Variables</a>
		</li></ul>
	</li><li><a href="/manual-beta/groups/">Groups</a>
	</li><li><a href="/manual-beta/mouse-actions/">Mouse Actions</a>
	</li><li><a href="/manual-beta/lua-scripting/">Lua Scripting</a>
		<ul>
		<li><a href="/manual-beta/lua-scripting/inline-lua/">Inline Lua</a>
		</li></ul>
	</li></ul>

	<h4>More</h4>
	<ul class="docs-nav-block">
	<li><a href="/manual/">4.3 Final Manual</a>
	</li><li><a href="/tips/">Tips &amp; Tricks</a>
	</li><li><a href="/snippets/">Snippets</a>
	</li><li><a href="/developers/">Developers</a>
	</li><li><a href="/history/">Version History</a>
	</li></ul>

</nav>

      </div>

      <!-- Content -->
      <div class="docs-content col-12 col-lg-9">
        <h1 class="page-title">WindowMessage plugin</h1>
        <hr>
        <!-- Include content and Replace "!" in every url with correct path -->
        <p><code>Plugin=WindowMessagePlugin</code> can be used to send and receive information from other applications. It can send window messages to other applications and show the result. For example, the plugin can be used to control WinAmp or some similar media players.</p>

<h2>Options</h2>
<dl>
	<dt>General measure options</dt>
	<dd>
		All <a href="/manual-beta/measures/general-options/">general measure options</a> are valid.
	</dd>

	<dt id="WindowName"><code>WindowName</code></dt>
	<dd>
		The name of the window. This is used to identify the window. It's not necessary to set this if the <code>WindowClass</code> is set.
	</dd>

	<dt id="WindowClass"><code>WindowClass</code></dt>
	<dd>
		The class of the window. This is used to identify the window. It's not necessary to set this if the <code>WindowName</code> is set.
	</dd>

	<dt id="WindowMessage"><code>WindowMessage</code></dt>
	<dd>
		This is the message to be send to the window. You need to define 3 parameters to where the first one is the <code>message</code> and the next ones are <code>wParam</code> and <code>lParam</code>. <b>Both wParam and lParam are unsigned decimal integers.</b> The measure returns the value returned by the SendMessage API function. If the <code>WindowMessage</code> is not given, the measure returns the window's current title.
	</dd>
</dl>

<h2>Bangs</h2>
<p>Messages can also be sent on demand with the <a href="/manual-beta/bangs/#CommandMeasure">!CommandMeasure</a> bang. The arguments are similar that of the <code>WindowMessage</code> option. <code>!CommandMeasure "MeasureName" "SendMessage Msg wParam lParam"</code></p>

<h2>Examples</h2>

<p>The following example returns the name of the song that is playing in WinAmp.</p>

<figure class="highlight ini"><table><tr><td class="code"><pre><span class="line"><span class="section">[MeasureWinamp]</span></span><br><span class="line"><span class="attr">Measure</span>=Plugin</span><br><span class="line"><span class="attr">Plugin</span>=WindowMessagePlugin</span><br><span class="line"><span class="attr">WindowClass</span>=Winamp v1.x</span><br><span class="line"><span class="attr">Substitute</span>=<span class="string">"[Paused]"</span>:<span class="string">""</span>,<span class="string">" - Winamp"</span>:<span class="string">""</span></span><br></pre></td></tr></table></figure>

<p>Check if Winamp is playing, or not. The following example returns <code>0</code> if it's not playing, <code>1</code> if it is playing, and <code>3</code> if it's paused.</p>

<figure class="highlight ini"><table><tr><td class="code"><pre><span class="line"><span class="section">[MeasureWinampPlaying]</span></span><br><span class="line"><span class="attr">Measure</span>=Plugin</span><br><span class="line"><span class="attr">Plugin</span>=WindowMessagePlugin</span><br><span class="line"><span class="attr">WindowClass</span>=Winamp v1.x</span><br><span class="line"><span class="attr">WindowMessage</span>=<span class="number">1024</span> <span class="number">0</span> <span class="number">104</span></span><br></pre></td></tr></table></figure>

<p>Show song progress. In the following example, the <code>[MeasureWinampDuration]</code> will return the current song position as a value between <code>0</code> and <code>1</code>. Then you can use the <a href="/manual-beta/meters/bar/">Bar</a> meter to display the value.</p>

<figure class="highlight ini"><table><tr><td class="code"><pre><span class="line"><span class="section">[MeasureWinampFull]</span></span><br><span class="line"><span class="attr">Measure</span>=Plugin</span><br><span class="line"><span class="attr">Plugin</span>=WindowMessagePlugin</span><br><span class="line"><span class="attr">WindowClass</span>=Winamp v1.x</span><br><span class="line"><span class="attr">WindowMessage</span>=<span class="number">1024</span> <span class="number">1</span> <span class="number">105</span></span><br><span class="line"></span><br><span class="line"><span class="section">[MeasureWinampCurr]</span></span><br><span class="line"><span class="attr">Measure</span>=Plugin</span><br><span class="line"><span class="attr">Plugin</span>=WindowMessagePlugin</span><br><span class="line"><span class="attr">WindowClass</span>=Winamp v1.x</span><br><span class="line"><span class="attr">WindowMessage</span>=<span class="number">1024</span> <span class="number">0</span> <span class="number">105</span></span><br><span class="line"></span><br><span class="line"><span class="section">[MeasureWinampDuration]</span></span><br><span class="line"><span class="attr">Measure</span>=Calc</span><br><span class="line"><span class="attr">Formula</span>=(MeasureWinampCurr&lt;=<span class="number">0</span>)?<span class="number">0</span>:(MeasureWinampCurr/(MeasureWinampFull*<span class="number">1000</span>+<span class="number">1</span>))</span><br></pre></td></tr></table></figure>


      </div>

    </div>
  </div>

</div>

<!-- Include Footer -->
<footer id="footer">
  <div class="container">
    <div class="row">
      <div class="col-6">Made with ❤ by the community.</div>
      <div class="col-6 text-right text-md-right">Icons by <a href="http://www.freepik.com" alt="Freepik">Freepik</a> and <a href="https://feathericons.com/" alt="feathericons">feathericons.com</a></div>
    </div>
  </div>
</footer>



	<!-- Javascript files  -->
	<script src="/js/main.js"></script>
	<script src="/js/jquery-3.2.1.slim.min.js"></script>
	<script src="/js/bootstrap.min.js"></script>
	<script src="/js/ahk-sliding-panel.js"></script>
	<script src="/js/jquery.fancybox.min.js"></script>

	<!-- Script for the slideout menu on mobile -->
	<script>
		// set slideout menu variables
		var docsnav = new ahk_slideout({
		  id: "menu",
		  side: "left",
		  width: "18rem",
		  touch_boundary: "50",
		  slide_time: "0.2"
		})

		// function to toggle menu
		function openNavMenu() {
		  docsnav.openMenu()
		}
		// function to close menu
		function closeNavMenu() {
		  docsnav.closeMenu()
		}

		// when scrolling below 90, add sticky class to nav-button
		$(function() {
		  var header = $("#nav-button");
		  $(window).scroll(function() {
		    var scroll = $(window).scrollTop();
		    if (scroll >= 90) {
		      header.addClass("sticky");
		    } else {
		      header.removeClass("sticky");
		    }
		  });
		});
	</script>

</body>
</html>
